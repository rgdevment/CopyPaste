<Window
    x:Class="CopyPaste.UI.Themes.CompactWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:viewmodels="using:CopyPaste.UI.Themes"
    xmlns:tb="using:H.NotifyIcon"
    Title="CopyPaste">

    <Window.SystemBackdrop>
        <MicaBackdrop/>
    </Window.SystemBackdrop>

    <Grid x:Name="RootGrid" Background="Transparent" PreviewKeyDown="RootGrid_PreviewKeyDown">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- System Tray Icon -->
        <tb:TaskbarIcon x:Name="TrayIcon"
                        IconSource="/Assets/CopyPasteLogoSimple.ico"
                        ToolTipText="CopyPaste"
                        DoubleClickCommand="{x:Bind ViewModel.ShowWindowCommand}"
                        MenuActivation="RightClick">
            <tb:TaskbarIcon.ContextFlyout>
                <MenuFlyout>
                    <MenuFlyoutItem x:Name="TrayMenuSettings" Click="TrayMenuSettings_Click">
                        <MenuFlyoutItem.Icon><FontIcon Glyph="&#xE713;"/></MenuFlyoutItem.Icon>
                    </MenuFlyoutItem>
                    <MenuFlyoutSeparator/>
                    <MenuFlyoutItem x:Name="TrayMenuExit" Command="{x:Bind ViewModel.ExitCommand}">
                        <MenuFlyoutItem.Icon><FontIcon Glyph="&#xE7E8;"/></MenuFlyoutItem.Icon>
                    </MenuFlyoutItem>
                </MenuFlyout>
            </tb:TaskbarIcon.ContextFlyout>
        </tb:TaskbarIcon>

        <!-- Top Tab Bar - also serves as drag region -->
        <Grid x:Name="TitleBarGrid" Grid.Row="0" Height="40">
            <!-- Left: Tabs -->
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" VerticalAlignment="Center" Spacing="2" Margin="8,0,0,0">
                <Button x:Name="RecentTab"
                        Width="32" Height="32" Padding="0"
                        Background="Transparent" BorderThickness="0" CornerRadius="4"
                        Click="RecentTab_Click"
                        ToolTipService.ToolTip="Recent">
                    <FontIcon x:Name="RecentTabIcon" Glyph="&#xE77F;" FontSize="16" Opacity="1.0"/>
                </Button>
                <Button x:Name="PinnedTab"
                        Width="32" Height="32" Padding="0"
                        Background="Transparent" BorderThickness="0" CornerRadius="4"
                        Click="PinnedTab_Click"
                        ToolTipService.ToolTip="Pinned">
                    <FontIcon x:Name="PinnedTabIcon" Glyph="&#xE718;" FontSize="16" Opacity="0.45"/>
                </Button>
            </StackPanel>

            <!-- Right: Utility icons + Close -->
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center" Spacing="0" Margin="0,0,4,0">
                <Button x:Name="SettingsButton"
                        Width="28" Height="28" Padding="0"
                        Background="Transparent" BorderThickness="0" CornerRadius="4"
                        Click="SettingsButton_Click"
                        ToolTipService.ToolTip="Settings">
                    <FontIcon Glyph="&#xE713;" FontSize="14" Opacity="0.6"/>
                </Button>
                <Button x:Name="HelpButton"
                        Width="28" Height="28" Padding="0"
                        Background="Transparent" BorderThickness="0" CornerRadius="4"
                        Click="HelpButton_Click"
                        ToolTipService.ToolTip="Help">
                    <FontIcon Glyph="&#xE765;" FontSize="14" Opacity="0.6"/>
                </Button>
                <Button x:Name="ReportBugButton"
                        Width="28" Height="28" Padding="0"
                        Background="Transparent" BorderThickness="0" CornerRadius="4"
                        Click="ReportBugButton_Click"
                        ToolTipService.ToolTip="Report a bug">
                    <FontIcon Glyph="&#xEBE8;" FontSize="14" Opacity="0.6"/>
                </Button>
                <Button x:Name="CloseButton"
                        Width="28" Height="28" Padding="0"
                        Background="Transparent" BorderThickness="0" CornerRadius="4"
                        Click="CloseButton_Click">
                    <FontIcon Glyph="&#xE711;" FontSize="10" Opacity="0.5"/>
                </Button>
            </StackPanel>
        </Grid>

        <!-- Header: Section Title -->
        <Grid Grid.Row="1" Margin="16,2,16,4">
            <TextBlock x:Name="SectionTitle"
                       Text="Clipboard"
                       FontSize="14"
                       FontWeight="SemiBold"
                       VerticalAlignment="Center"
                       HorizontalAlignment="Left"
                       Opacity="0.9"/>
        </Grid>

        <!-- Search/Filter Bar -->
        <Grid Grid.Row="2" Margin="12,4,12,6">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Content search (text) -->
            <TextBox x:Name="SearchBox"
                     Grid.Column="0"
                     Text="{x:Bind ViewModel.SearchQuery, Mode=TwoWay}"
                     TextChanged="SearchBox_TextChanged"
                     Padding="8,6"
                     FontSize="12"
                     BorderThickness="1"
                     BorderBrush="{ThemeResource SurfaceStrokeColorDefaultBrush}"
                     Background="{ThemeResource SurfaceStrokeColorDefaultBrush}"
                     CornerRadius="6"
                     Visibility="{x:Bind ViewModel.IsContentFilterMode, Mode=OneWay}"/>

            <!-- Category filter (colors) -->
            <Grid x:Name="ColorFilterPanel"
                  Grid.Column="0"
                  KeyDown="FilterChips_KeyDown"
                  Visibility="{x:Bind ViewModel.IsCategoryFilterMode, Mode=OneWay}">
                <Button x:Name="ColorDropdownButton"
                        HorizontalAlignment="Stretch"
                        HorizontalContentAlignment="Left"
                        Padding="8,6"
                        Background="{ThemeResource SurfaceStrokeColorDefaultBrush}"
                        BorderBrush="{ThemeResource SurfaceStrokeColorDefaultBrush}"
                        BorderThickness="1"
                        CornerRadius="6">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <StackPanel x:Name="SelectedColorsPanel" Grid.Column="0" Orientation="Horizontal" Spacing="6">
                            <TextBlock x:Name="ColorPlaceholder" Text="Colors..." Opacity="0.5" FontSize="12" VerticalAlignment="Center"/>
                        </StackPanel>
                        <FontIcon Grid.Column="1" Glyph="&#xE70D;" FontSize="10" Opacity="0.5" Margin="6,0,0,0" VerticalAlignment="Center"/>
                    </Grid>
                    <Button.Flyout>
                        <Flyout x:Name="ColorFlyout" Placement="BottomEdgeAlignedLeft">
                            <StackPanel Spacing="2" MinWidth="120">
                                <CheckBox x:Name="ColorCheckRed" Tag="Red" Checked="ColorCheckBox_Changed" Unchecked="ColorCheckBox_Changed" MinHeight="28">
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <Ellipse Width="12" Height="12" Fill="#E74C3C" VerticalAlignment="Center"/>
                                        <TextBlock x:Name="ColorLabelRed" Text="Red" FontSize="12" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </CheckBox>
                                <CheckBox x:Name="ColorCheckGreen" Tag="Green" Checked="ColorCheckBox_Changed" Unchecked="ColorCheckBox_Changed" MinHeight="28">
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <Ellipse Width="12" Height="12" Fill="#2ECC71" VerticalAlignment="Center"/>
                                        <TextBlock x:Name="ColorLabelGreen" Text="Green" FontSize="12" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </CheckBox>
                                <CheckBox x:Name="ColorCheckPurple" Tag="Purple" Checked="ColorCheckBox_Changed" Unchecked="ColorCheckBox_Changed" MinHeight="28">
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <Ellipse Width="12" Height="12" Fill="#9B59B6" VerticalAlignment="Center"/>
                                        <TextBlock x:Name="ColorLabelPurple" Text="Purple" FontSize="12" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </CheckBox>
                                <CheckBox x:Name="ColorCheckYellow" Tag="Yellow" Checked="ColorCheckBox_Changed" Unchecked="ColorCheckBox_Changed" MinHeight="28">
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <Ellipse Width="12" Height="12" Fill="#F1C40F" VerticalAlignment="Center"/>
                                        <TextBlock x:Name="ColorLabelYellow" Text="Yellow" FontSize="12" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </CheckBox>
                                <CheckBox x:Name="ColorCheckBlue" Tag="Blue" Checked="ColorCheckBox_Changed" Unchecked="ColorCheckBox_Changed" MinHeight="28">
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <Ellipse Width="12" Height="12" Fill="#3498DB" VerticalAlignment="Center"/>
                                        <TextBlock x:Name="ColorLabelBlue" Text="Blue" FontSize="12" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </CheckBox>
                                <CheckBox x:Name="ColorCheckOrange" Tag="Orange" Checked="ColorCheckBox_Changed" Unchecked="ColorCheckBox_Changed" MinHeight="28">
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <Ellipse Width="12" Height="12" Fill="#E67E22" VerticalAlignment="Center"/>
                                        <TextBlock x:Name="ColorLabelOrange" Text="Orange" FontSize="12" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </CheckBox>
                            </StackPanel>
                        </Flyout>
                    </Button.Flyout>
                </Button>
            </Grid>

            <!-- Type filter -->
            <Grid x:Name="TypeFilterPanel"
                  Grid.Column="0"
                  KeyDown="FilterChips_KeyDown"
                  Visibility="{x:Bind ViewModel.IsTypeFilterMode, Mode=OneWay}">
                <Button x:Name="TypeDropdownButton"
                        HorizontalAlignment="Stretch"
                        HorizontalContentAlignment="Left"
                        Padding="8,6"
                        Background="{ThemeResource SurfaceStrokeColorDefaultBrush}"
                        BorderBrush="{ThemeResource SurfaceStrokeColorDefaultBrush}"
                        BorderThickness="1"
                        CornerRadius="6">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <StackPanel x:Name="SelectedTypesPanel" Grid.Column="0" Orientation="Horizontal" Spacing="6">
                            <TextBlock x:Name="TypePlaceholder" Text="Types..." Opacity="0.5" FontSize="12" VerticalAlignment="Center"/>
                        </StackPanel>
                        <FontIcon Grid.Column="1" Glyph="&#xE70D;" FontSize="10" Opacity="0.5" Margin="6,0,0,0" VerticalAlignment="Center"/>
                    </Grid>
                    <Button.Flyout>
                        <Flyout x:Name="TypeFlyout" Placement="BottomEdgeAlignedLeft">
                            <StackPanel Spacing="2" MinWidth="120">
                                <CheckBox x:Name="TypeCheckText" Tag="Text" Checked="TypeCheckBox_Changed" Unchecked="TypeCheckBox_Changed" MinHeight="28">
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <FontIcon Glyph="&#xE8C1;" FontSize="12" VerticalAlignment="Center"/>
                                        <TextBlock x:Name="TypeLabelText" Text="Text" FontSize="12" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </CheckBox>
                                <CheckBox x:Name="TypeCheckImage" Tag="Image" Checked="TypeCheckBox_Changed" Unchecked="TypeCheckBox_Changed" MinHeight="28">
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <FontIcon Glyph="&#xE91B;" FontSize="12" VerticalAlignment="Center"/>
                                        <TextBlock x:Name="TypeLabelImage" Text="Image" FontSize="12" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </CheckBox>
                                <CheckBox x:Name="TypeCheckFile" Tag="File" Checked="TypeCheckBox_Changed" Unchecked="TypeCheckBox_Changed" MinHeight="28">
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <FontIcon Glyph="&#xE7C3;" FontSize="12" VerticalAlignment="Center"/>
                                        <TextBlock x:Name="TypeLabelFile" Text="File" FontSize="12" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </CheckBox>
                                <CheckBox x:Name="TypeCheckFolder" Tag="Folder" Checked="TypeCheckBox_Changed" Unchecked="TypeCheckBox_Changed" MinHeight="28">
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <FontIcon Glyph="&#xE8B7;" FontSize="12" VerticalAlignment="Center"/>
                                        <TextBlock x:Name="TypeLabelFolder" Text="Folder" FontSize="12" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </CheckBox>
                                <CheckBox x:Name="TypeCheckLink" Tag="Link" Checked="TypeCheckBox_Changed" Unchecked="TypeCheckBox_Changed" MinHeight="28">
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <FontIcon Glyph="&#xE71B;" FontSize="12" VerticalAlignment="Center"/>
                                        <TextBlock x:Name="TypeLabelLink" Text="Link" FontSize="12" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </CheckBox>
                                <CheckBox x:Name="TypeCheckAudio" Tag="Audio" Checked="TypeCheckBox_Changed" Unchecked="TypeCheckBox_Changed" MinHeight="28">
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <FontIcon Glyph="&#xE8D6;" FontSize="12" VerticalAlignment="Center"/>
                                        <TextBlock x:Name="TypeLabelAudio" Text="Audio" FontSize="12" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </CheckBox>
                                <CheckBox x:Name="TypeCheckVideo" Tag="Video" Checked="TypeCheckBox_Changed" Unchecked="TypeCheckBox_Changed" MinHeight="28">
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <FontIcon Glyph="&#xE714;" FontSize="12" VerticalAlignment="Center"/>
                                        <TextBlock x:Name="TypeLabelVideo" Text="Video" FontSize="12" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </CheckBox>
                            </StackPanel>
                        </Flyout>
                    </Button.Flyout>
                </Button>
            </Grid>

            <!-- Filter mode button -->
            <Button x:Name="FilterModeButton"
                    Grid.Column="1"
                    Width="30" Height="30"
                    Margin="4,0,0,0"
                    Padding="0"
                    Background="Transparent"
                    BorderThickness="0"
                    CornerRadius="6">
                <FontIcon x:Name="FilterModeIcon" Glyph="&#xE71C;" FontSize="14" Opacity="0.5"/>
                <Button.Flyout>
                    <MenuFlyout Placement="BottomEdgeAlignedRight">
                        <RadioMenuFlyoutItem x:Name="FilterModeContent" Text="Content" IsChecked="True" Click="FilterModeItem_Click" Tag="0"/>
                        <RadioMenuFlyoutItem x:Name="FilterModeCategory" Text="Category" Click="FilterModeItem_Click" Tag="1"/>
                        <RadioMenuFlyoutItem x:Name="FilterModeType" Text="Type" Click="FilterModeItem_Click" Tag="2"/>
                    </MenuFlyout>
                </Button.Flyout>
            </Button>
        </Grid>

        <!-- Empty State -->
        <StackPanel Grid.Row="3"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Spacing="8"
                    Visibility="{x:Bind ViewModel.IsEmpty, Mode=OneWay}">
            <FontIcon Glyph="&#xE77F;" FontSize="28" Opacity="0.2" HorizontalAlignment="Center"/>
            <TextBlock x:Name="EmptyStateText"
                       FontSize="12"
                       Opacity="0.4"
                       HorizontalAlignment="Center"/>
        </StackPanel>

        <!-- Clipboard Items List -->
        <ListView x:Name="ClipboardListView"
                  Grid.Row="3"
                  ItemsSource="{x:Bind ViewModel.Items, Mode=OneWay}"
                  SelectionMode="Single"
                  IsTabStop="True"
                  TabNavigation="Once"
                  SingleSelectionFollowsFocus="True"
                  PreviewKeyDown="ClipboardListView_PreviewKeyDown"
                  Padding="4,0,4,8"
                  ContainerContentChanging="ClipboardListView_ContainerContentChanging">
            <ListView.ItemContainerStyle>
                <Style TargetType="ListViewItem">
                    <Setter Property="Padding" Value="0"/>
                    <Setter Property="Margin" Value="0"/>
                    <Setter Property="MinHeight" Value="0"/>
                    <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                    <Setter Property="Background" Value="Transparent"/>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="ListViewItem">
                                <ContentPresenter/>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </ListView.ItemContainerStyle>
            <ListView.ItemsPanel>
                <ItemsPanelTemplate>
                    <ItemsStackPanel Orientation="Vertical"/>
                </ItemsPanelTemplate>
            </ListView.ItemsPanel>
            <ListView.ItemTemplate>
                <DataTemplate x:DataType="viewmodels:ClipboardItemViewModel">
                    <Border MinHeight="44"
                            CornerRadius="8"
                            Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                            BorderThickness="1"
                            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                            Margin="8,0,8,6"
                            Tag="{x:Bind}"
                            PointerEntered="Card_PointerEntered"
                            PointerExited="Card_PointerExited">
                        <Border.ContextFlyout>
                            <MenuFlyout>
                                <MenuFlyoutItem Text="{x:Bind PasteText}" Icon="Paste" Command="{x:Bind PasteCommand}"/>
                                <MenuFlyoutItem Text="{x:Bind PastePlainText}" Command="{x:Bind PastePlainCommand}">
                                    <MenuFlyoutItem.Icon><FontIcon Glyph="&#xE75F;"/></MenuFlyoutItem.Icon>
                                </MenuFlyoutItem>
                                <MenuFlyoutSeparator/>
                                <MenuFlyoutItem Text="{x:Bind PinMenuText, Mode=OneWay}" Command="{x:Bind TogglePinCommand}">
                                    <MenuFlyoutItem.Icon><FontIcon Glyph="{x:Bind PinIconGlyph, Mode=OneWay}"/></MenuFlyoutItem.Icon>
                                </MenuFlyoutItem>
                                <MenuFlyoutItem Text="{x:Bind EditText}" Command="{x:Bind EditCommand}" Visibility="{x:Bind CanEdit}">
                                    <MenuFlyoutItem.Icon><FontIcon Glyph="&#xE70F;"/></MenuFlyoutItem.Icon>
                                </MenuFlyoutItem>
                                <MenuFlyoutSeparator/>
                                <MenuFlyoutItem Text="{x:Bind DeleteText}" Command="{x:Bind DeleteCommand}">
                                    <MenuFlyoutItem.Icon><FontIcon Glyph="&#xE711;"/></MenuFlyoutItem.Icon>
                                </MenuFlyoutItem>
                            </MenuFlyout>
                        </Border.ContextFlyout>
                        <Grid>
                            <!-- Color indicator (left edge) -->
                            <Border HorizontalAlignment="Left" Width="3"
                                    CornerRadius="8,0,0,8" Margin="-1,-1,0,-1"
                                    Visibility="{x:Bind CardColorVisibility, Mode=OneWay}">
                                <Border.Background>
                                    <SolidColorBrush Color="{x:Bind CardBorderColor, Mode=OneWay}"/>
                                </Border.Background>
                            </Border>

                            <!-- Content area with header + body + footer -->
                            <Grid Padding="12,6,12,6">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <!-- Card header: type icon + label/name (left) + timestamp + hover actions (right) -->
                                <Grid Grid.Row="0" Margin="0,0,0,4">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="5">
                                        <FontIcon Glyph="{x:Bind TypeIcon}" FontSize="10" Opacity="0.4"/>
                                        <TextBlock Text="{x:Bind Label}" FontSize="11" Opacity="0.5"
                                                   FontWeight="SemiBold" MaxLines="1" TextTrimming="CharacterEllipsis"
                                                   Visibility="{x:Bind LabelVisibility}"/>
                                        <TextBlock Text="{x:Bind HeaderTitle}" FontSize="11" Opacity="0.4"
                                                   MaxLines="1" Visibility="{x:Bind DefaultHeaderVisibility}"/>
                                    </StackPanel>
                                    <Grid Grid.Column="1" VerticalAlignment="Center">
                                        <!-- Timestamp (visible by default, hidden on hover) -->
                                        <TextBlock x:Name="TimestampText" Text="{x:Bind Timestamp}" FontSize="10" Opacity="0.35"
                                                   VerticalAlignment="Center" Margin="8,0,0,0"/>
                                        <!-- Hover action buttons (hidden by default, shown on hover) -->
                                        <StackPanel x:Name="HoverActions" Orientation="Horizontal" Spacing="2"
                                                    Opacity="0" VerticalAlignment="Center" Margin="4,0,0,0">
                                            <Button Command="{x:Bind TogglePinCommand}"
                                                    Width="22" Height="22" Padding="0"
                                                    Background="Transparent" BorderThickness="0" CornerRadius="4"
                                                    ToolTipService.ToolTip="{x:Bind PinMenuText, Mode=OneWay}">
                                                <FontIcon Glyph="{x:Bind PinIconGlyph, Mode=OneWay}" FontSize="11" Opacity="0.6"/>
                                            </Button>
                                            <Button Command="{x:Bind EditCommand}"
                                                    Visibility="{x:Bind CanEdit}"
                                                    Width="22" Height="22" Padding="0"
                                                    Background="Transparent" BorderThickness="0" CornerRadius="4"
                                                    ToolTipService.ToolTip="{x:Bind EditText}">
                                                <FontIcon Glyph="&#xE70F;" FontSize="11" Opacity="0.6"/>
                                            </Button>
                                            <Button Command="{x:Bind DeleteCommand}"
                                                    Width="22" Height="22" Padding="0"
                                                    Background="Transparent" BorderThickness="0" CornerRadius="4"
                                                    ToolTipService.ToolTip="{x:Bind DeleteText}">
                                                <FontIcon Glyph="&#xE711;" FontSize="11" Opacity="0.6"/>
                                            </Button>
                                        </StackPanel>
                                    </Grid>
                                </Grid>

                                <!-- Text content -->
                                <TextBlock Grid.Row="1" Text="{x:Bind Content, Mode=OneWay}"
                                           MaxLines="{x:Bind ContentMaxLines, Mode=OneWay}"
                                           TextTrimming="CharacterEllipsis"
                                           FontSize="13" Opacity="0.85" TextWrapping="Wrap"
                                           Visibility="{x:Bind IsTextVisible, Mode=OneWay}"/>

                                <!-- Image content -->
                                <Border x:Name="ImageBorder" Grid.Row="1" CornerRadius="4"
                                        Visibility="{x:Bind ImageVisibility, Mode=OneWay}"
                                        HorizontalAlignment="Stretch" Height="70" Opacity="0.7"
                                        Background="{ThemeResource CardBackgroundFillColorSecondaryBrush}">
                                    <Image x:Name="ClipboardImage"
                                           Stretch="Uniform"
                                           HorizontalAlignment="Center" VerticalAlignment="Center"
                                           Tag="{x:Bind ImagePath, Mode=OneWay}"/>
                                </Border>

                                <!-- Media thumbnail -->
                                <Border x:Name="MediaBorder" Grid.Row="1" CornerRadius="4"
                                        Visibility="{x:Bind MediaThumbnailVisibility, Mode=OneWay}"
                                        HorizontalAlignment="Stretch" Height="70" Opacity="0.7"
                                        Background="{ThemeResource CardBackgroundFillColorSecondaryBrush}">
                                    <Image Source="{x:Bind ThumbnailPath, Mode=OneWay}"
                                           Stretch="Uniform"
                                           HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>

                                <!-- File warning -->
                                <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,4,0,0"
                                            Visibility="{x:Bind FileWarningVisibility, Mode=OneWay}">
                                    <FontIcon Glyph="&#xE7BA;" FontSize="10" Foreground="#FFAA00" Margin="0,0,4,0"/>
                                    <TextBlock Text="{x:Bind FileWarningText}" FontSize="10" Foreground="#FFAA00"/>
                                </StackPanel>

                                <!-- Card footer: source + size + paste count -->
                                <Grid Grid.Row="3" Margin="0,4,0,0">
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" Spacing="4"
                                                Visibility="{x:Bind AppSourceVisibility}">
                                        <FontIcon Glyph="&#xE7C3;" FontSize="9" Opacity="0.3"/>
                                        <TextBlock Text="{x:Bind AppSource}" FontSize="10" Opacity="0.35"
                                                   MaxLines="1" TextTrimming="CharacterEllipsis" MaxWidth="140"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Spacing="6">
                                        <TextBlock Text="{x:Bind PasteCountDisplay, Mode=OneWay}" FontSize="10" Opacity="0.35"
                                                   Visibility="{x:Bind PasteCountVisibility, Mode=OneWay}"/>
                                        <TextBlock Text="{x:Bind ImageDimensions}" FontSize="10" Opacity="0.35"
                                                   Visibility="{x:Bind ImageDimensionsVisibility}"/>
                                        <TextBlock Text="{x:Bind FileSize}" FontSize="10" Opacity="0.35"
                                                   Visibility="{x:Bind FileSizeVisibility}"/>
                                    </StackPanel>
                                </Grid>
                            </Grid>


                        </Grid>
                    </Border>
                </DataTemplate>
            </ListView.ItemTemplate>
        </ListView>

        <!-- Bottom Branding Bar -->
        <Grid Grid.Row="4" Margin="12,4,12,8">
            <StackPanel Orientation="Horizontal"
                        HorizontalAlignment="Center"
                        Spacing="6"
                        Opacity="0.4">
                <Image x:Name="AppLogoImage"
                       Source="/Assets/CopyPasteNotification.ico"
                       Width="14" Height="14"
                       VerticalAlignment="Center"/>
                <TextBlock x:Name="AppNameText"
                           Text="CopyPaste"
                           FontSize="11"
                           FontWeight="SemiBold"
                           VerticalAlignment="Center"/>
            </StackPanel>
        </Grid>
    </Grid>
</Window>
